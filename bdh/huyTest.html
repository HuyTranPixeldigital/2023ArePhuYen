<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anna Vũ Hoài Phương</title>
    <link rel="stylesheet" href="../style.css" >
</head>

<body>
    <div class="profile-container">
		<div class="profile-header">
			<img src="01.jpg" alt="Nguyễn Văn Linh " style="width: 150px; height: 150px; border-radius: 50%; margin-bottom: 10px; object-fit: cover;">
			<h2>Anna</h2>
			<h2>Vũ Hoài Phương</h2>
			<p>hoaiphuong30102001@gmail.com</p>
			<p>0938322840</p>
		</div>
        <div class="profile-details">
            <h3> Details:</h3>
            <ul class="skills">
                <li>Giáo Xứ Bình Thuận</li>
                <li>Giáo Hạt Tân Sơn Nhì</li>
				<li>Đội 12</li>
            </ul>
        </div>
		<div class="skills">
			<h2>Khóa Bồi Dưỡng Sinh Hoạt 2023: </h2>			
			<div class="attendance">
				<h4>Điểm danh:</h4>
				<div class="checkbox-grid"></div>
			</div>
			<!-- Kỹ năng 1 -->
			<h4>Chuyên Cần:</h4>
			<div class="skill-container">
				<div class="skill-bar skill-level" style="width: 100%;">100%</div>
			</div>
			<!-- Thêm kỹ năng khác ở đây... -->
		</div>
    </div>
	<script>
		async function fetchDataFromServer() {
			try {
				let response = await fetch('../data.csv');
				let userId = 5;
				let data = await response.text();

				let rows = data.split('\n');
    			        let jsonData = [];

				let headers = rows[0].split(',');
				
				//xử lý mảng
				for(let i = 1; i < rows.length; i++) {
					let obj = {};
					let currentRow = rows[i].split(',');

					for(let j = 0; j < headers.length; j++) {
						obj[headers[j]] = currentRow[j];
					}

					jsonData.push(obj);
				}
				// Lúc này, jsonData là một mảng các đối tượng có dữ liệu từ tệp CSV

				let user = jsonData.find(p => p.id === userId); // Tìm người dùng có id trùng với id của người dùng hiện tại
				console.log(user)
				let diemDanh = user.diemDanh.split(',');

				console.log(user);

				const activeCount = diemDanh.filter(Boolean).length; // Đếm số lượng giá trị true
				const chuyencan = (activeCount / 9) * 100;

				const checkboxContainer = document.querySelector(".checkbox-grid");
				const skillBar = document.querySelector(".skill-bar");
				
				// Cập nhật phần trăm cho skill-bar
				skillBar.style.width = `${chuyencan.toFixed(2)}%`;
				skillBar.textContent = `${chuyencan.toFixed(2)}%`;			
			
				diemDanh.forEach((isChecked, index) => {
					const container = document.createElement("div");
					container.className = "checkbox-container";

					const checkbox = document.createElement("input");
					checkbox.type = "checkbox";
					checkbox.id = "checkbox" + index;
					checkbox.checked = isChecked;
					checkbox.disabled = true;

					const label = document.createElement("label");
					label.htmlFor = "checkbox" + index;
					label.textContent = "Ngày " + (index + 1);

					container.appendChild(checkbox);
					container.appendChild(label);
					checkboxContainer.appendChild(container);
				});
				
				

			} catch (error) {
				console.error("Lỗi khi lấy dữ liệu từ máy chủ:", error);
			}
		}

		window.onload = fetchDataFromServer;
	</script>
</body>

</html>
